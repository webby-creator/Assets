var scripting;(()=>{"use strict";var e,t,r,n,s,i={d:(e,t)=>{for(var r in t)i.o(t,r)&&!i.o(e,r)&&Object.defineProperty(e,r,{enumerable:!0,get:t[r]})},o:(e,t)=>Object.prototype.hasOwnProperty.call(e,t),r:e=>{"undefined"!=typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(e,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(e,"__esModule",{value:!0})}},a={};i.r(a),i.d(a,{MIXIN_LIST:()=>g,default:()=>te,loadAndRegister:()=>ee,typeToElementFunc:()=>Y});class o{_clickable_listeners=new Map;onClick(e){const t=c(),r=this.element;r.addEventListener("click",e);const n=()=>{r.removeEventListener("click",e)};return this._clickable_listeners.set(t,{type:"click",listener:e,dropper:n}),n}onDblClick(e){const t=c(),r=this.element;r.addEventListener("dblclick",e);const n=()=>{r.removeEventListener("dblclick",e)};return this._clickable_listeners.set(t,{type:"dblclick",listener:e,dropper:n}),n}_reInitListeners(e){this._clickable_listeners.values().forEach((t=>{t.dropper(),"click"==t.type?(e.addEventListener("click",t.listener),t.dropper=()=>e.removeEventListener("click",t.listener)):(e.addEventListener("dblclick",t.listener),t.dropper=()=>e.removeEventListener("dblclick",t.listener))}))}_destroyListeners(){this._clickable_listeners.values().forEach((e=>e.dropper())),this._clickable_listeners=new Map}static NAME="click"}function c(){return Date.now().toString(36)+Math.floor(1e3*Math.random())}!function(e){e.Click="click",e.DblClick="dblClick"}(e||(e={}));class l{hide(){this.element.style.display="none"}show(){this.element.style.display=""}is_hidden(){return"none"==this.element.style.display}static NAME="collapse"}!function(e){e.Hide="hide",e.Show="show"}(t||(t={}));class d{destroy(){this.element.remove()}static NAME="delete"}!function(e){e.Destroy="destroy"}(r||(r={}));class u{effects=[];static NAME="effects"}class h{id;type;constructor(e,t){this.type=e,this.id=t.getAttribute("data-id")??""}static NAME="node"}class m{onViewportEnter(e){}onViewportLeave(e){}static NAME="viewport"}function p(e,t,r){for(const n of e.children){const e=t(n,r??null);p(n,t,e??r)}}function f(e,t){Object.defineProperty(e,Symbol.hasInstance,{value:e=>t.includes(e)}),t.forEach((t=>{Object.getOwnPropertyNames(t.prototype).forEach((r=>{Object.defineProperty(e.prototype,r,Object.getOwnPropertyDescriptor(t.prototype,r)||Object.create(null))}))}))}!function(e){e.Enter="enter",e.Leave="leave"}(n||(n={}));class b{program;node;element;parent;children=new Array;customClassList=new Array;constructor(e,t,r,n){this.node=new h(e,t),this.parent=r,this.element=t,this.program=n,null!=r&&r.children.push(this)}onLoaded(){}scrollTo(){this.element.scrollTo({behavior:"smooth"})}get type(){return this.node.type}get id(){return this.node.id}static NAME="element"}f(b,[m,l]),function(e){e.Type="type",e.Id="id",e.Parent="parent"}(s||(s={}));const g=[o,l,d,u,b,h,m];e.Click,e.DblClick,t.Hide,t.Show,r.Destroy,s.Id,s.Parent,s.Type,n.Enter,n.Leave;class y extends b{constructor(e,t,r){super("accordion",e,t,r)}}class w extends b{constructor(e,t,r){super("accordion_item",e,t,r)}}class _{_enabled=!0;disable(){this._enabled=!1,M(this.element,this._enabled)}enable(){this._enabled=!0,M(this.element,this._enabled)}get enabled(){return this._enabled}static NAME="disable"}function M(e,t){t?e.removeAttribute("data-disabled"):e.setAttribute("data-disabled","true"),e instanceof HTMLButtonElement&&(e.disabled=!t)}class I extends b{constructor(e,t,r){super("button",e,t,r),Object.assign(this,new o),Object.assign(this,new _),Object.assign(this,new u)}onLoaded(){this.element instanceof HTMLButtonElement?this.element.disabled&&this.disable():this.element.hasAttribute("disabled")&&"true"==this.element.getAttribute("disabled")&&this.disable()}get target(){return this.element.target}set target(e){this.element.target=e}get link(){return this.element instanceof HTMLButtonElement?"":this.element.href}set link(e){if(this.element instanceof HTMLButtonElement){if(0==e.trim().length)return;const t=document.createElement("a");t.target="_blank",t.className=this.element.className,t.id=this.element.id;for(let e in this.element.dataset)t.setAttribute(`data-${e}`,this.element.dataset[e]);this.element.hasAttribute("style")&&t.setAttribute("style",this.element.getAttribute("style")),t.append(...this.element.childNodes),this.element.replaceWith(t),this.element=t,this._reInitListeners(t)}if(0==e.trim().length){const e=document.createElement("button");e.className=this.element.className,e.id=this.element.id;for(let t in this.element.dataset)e.setAttribute(`data-${t}`,this.element.dataset[t]);this.element.hasAttribute("style")&&e.setAttribute("style",this.element.getAttribute("style")),e.append(...this.element.childNodes),this.element.replaceWith(e),this.element=e,this._reInitListeners(e)}else this.element.href=e}get text(){return this.element.innerText}set text(e){this.element.innerText=e}}f(I,[o,l,d,u,_]);class A extends b{cachedQuery=null;constructor(e,t,r){super("form",e,t,r)}getFormId(){let e;e=$t.debug?this.element.firstElementChild:this.element;for(const t of e.children)if("FORM"==t.nodeName)return t.action.split("/").slice(-2,-1)[0];return null}async setFormId(e){let t;t=$t.debug?this.element.firstElementChild:this.element;for(const r of t.children)if("FORM"==r.nodeName){if(r.remove(),null==e)return;break}if(null!=e){const r=this.query,n=await async function(e,t={}){t.mode="cors",t.credentials="include",null!=t.body&&(t.headers={"Content-Type":"application/json"});const r=await fetch(e,t);return await r.text()}(`https://api.dinko.space/form/${$t.storeId}/${e}/render${r?`?${r}`:""}`);t.insertAdjacentHTML("beforeend",n)}}get query(){let e;e=$t.debug?this.element.firstElementChild:this.element;for(const t of e.children)if("FORM"==t.nodeName){const e=t.action.split("?").slice(1,2)[0]??null;return this.cachedQuery=e,e}return this.cachedQuery}set query(e){let t;this.cachedQuery=e,t=$t.debug?this.element.firstElementChild:this.element;for(const r of t.children)if("FORM"==r.nodeName)return r.action=r.action.split("?")[0],void(null!=e&&0!=e.trim().length&&(r.action=`${r.action}?${e}`))}}f(A,[l,d]);class x extends b{constructor(e,t,r){super("container",e,t,r)}}f(x,[d]);class E extends b{constructor(e,t,r){super("footer",e,t,r)}}class v extends b{constructor(e,t,r){super("global",e,t,r)}}class k extends b{constructor(e,t,r){super("header",e,t,r)}}class L extends b{constructor(e,t,r){super("iframe",e,t,r)}}class T extends b{constructor(e,t,r){super("image",e,t,r)}}class S extends b{constructor(e,t,r){super("input",e,t,r)}}class $ extends b{constructor(e,t,r){super("menu",e,t,r)}}class N extends b{children=new Array;constructor(e,t,r){super("multi_state_box",e,t,r)}get currentState(){const e=parseInt(this.element.dataset.stateActive);return this.children[e]}get states(){return this.children}changeState(e){let t=0;const r=parseInt(this.element.dataset.stateActive);if(this.children[r].element.style.display="none","number"==typeof e)t=e;else if("string"==typeof e){const r=this.children.findIndex((t=>t.id==e));if(null==r)throw new Error("Unable to find State ID "+e);t=r}else{const r=this.children.findIndex((t=>t.id==e.id));if(null==r)throw new Error("Unable to find State ID "+e.id);t=r}return this.element.dataset.stateActive=""+t,this.children[t].element.style.display="",this.children[t]}}f(N,[d]);class C extends b{constructor(e,t,r){super("multi_state_box_item",e,t,r)}get id(){return this.element.dataset.stateName}}class O extends b{constructor(e,t,r){super("section",e,t,r)}}f(O,[d]);class D extends b{constructor(e,t,r){super("stack",e,t,r)}}class j extends b{constructor(e,t,r){super("text",e,t,r)}get text(){return this.element.firstElementChild.innerText}set text(e){this.element.firstElementChild.innerText=e}get html(){return this.element.innerHTML}set html(e){this.element.innerHTML=e}}f(j,[o,l,d,u]);class q extends b{constructor(e,t,r){super("vector_art",e,t,r)}}class F extends b{constructor(e,t,r){super("website",e,t,r)}}class H extends b{constructor(e,t,r){super("gallery",e,t,r)}}function U(e,t,r){if(Array.isArray(e)){let n=[];for(const s of e){const e=U(s,t,r);Array.isArray(e)?n.push(...e):null!=e&&n.push(e)}return n}if(0==e.length||e.startsWith("#")&&1==e.length)throw new Error("Invalid Query");const n=e.split(",");if(n.length>1){let e=[];for(const s of n){const n=U(s.trim(),t,r);Array.isArray(n)?e.push(...n):null!=n&&e.push(n)}return e}let s=null;var i;if(e.startsWith("#")?s=null!=t.queryIdMap?t.htmlIdMap.get(t.queryIdMap[e.slice(1)]??e.slice(1))??null:t.htmlIdMap.get(e.slice(1))??null:(i=e,J.includes(i)&&(s=t.typeMap.get(e)??[])),null!=s&&null!=r?.container){if(!r.container.startsWith("#"))throw new Error("Container MUST Reference the ID");const e=U(r.container,t);if(null==e)throw new Error("Unable to find container");if(Array.isArray(e))throw new Error("Only one container can be returned");return Array.isArray(s)?s.filter((t=>B(t,e))):B(s,e)?s:null}return s}function B(e,t){return null!=e.parent&&(e.parent.id==t.id||B(e.parent,t))}class P{storeId;debug;registered=[];htmlIdMap=new Map;typeMap=new Map;queryIdMap=null;constructor(e,t){this.storeId=e,this.debug=t?.debug??!1,this.queryIdMap=t?.idMap??null,this.register(t?.container??document.body)}register(e){p(e,((e,t)=>{const r=e.getAttribute("data-id"),n=e.getAttribute("data-type");if(null!=r&&e instanceof HTMLElement){if(null==n||!z(n))throw new Error("Invalid/No Type Found for "+r);const s=K(n,e,t,this),i=Z(s.type);return this.typeMap.has(i)||this.typeMap.set(i,[]),this.registered.push(s),this.htmlIdMap.set(s.id,s),this.typeMap.get(i)?.push(s),s}})),this.registered.slice().reverse().forEach((e=>e.onLoaded()))}query(e,t){return U(e,this,t)}duplicate(e){const t=e.element.cloneNode(!0);e.parent.element.appendChild(t);const r=[],n=R(t,e.parent,r,this);return p(t,((e,t)=>R(e,t,r,this)),n),r.reverse().forEach((e=>e.onLoaded())),n}delete(e,t=!0){if(t){const t=e.parent?.children.findIndex((t=>t.id==e.id));null!=t&&(e.parent.children.splice(t,1),e.element.remove())}const r=this.registered.findIndex((t=>t.id==e.id));null!=r&&this.registered.splice(r,1),this.htmlIdMap.delete(e.id);const n=Z(e.type);let s=this.typeMap.get(n);const i=s.findIndex((t=>t.id==e.id));null!=i&&s.splice(i,1),e.children.forEach((e=>this.delete(e,!1)))}}function R(e,t,r,n){const s=e.getAttribute("data-id"),i=e.getAttribute("data-type");if(null!=s&&e instanceof HTMLElement){if(null==i||!z(i))throw new Error("Invalid/No Type Found for "+s);let a=`dupe${Date.now()}${Math.floor(1e4*Math.random())}`;for(;n.htmlIdMap.has(a);)a=`dupe${Date.now()}${Math.floor(1e4*Math.random())}`;let o=crypto.randomUUID();for(;null!=document.querySelector(`[data-guid="${o}"]`);)a=crypto.randomUUID();e.setAttribute("data-id",a),e.setAttribute("data-guid",o);const c=K(i,e,t,n),l=Z(c.type);return r.push(c),n.registered.push(c),n.htmlIdMap.set(c.id,c),n.typeMap.get(l)?.push(c),c}}class W extends b{_data=[];_onItemAddListener=null;constructor(e,t,r){super("repeater",e,t,r)}onLoaded(){this.data=this.children.map((e=>({_id:e.id})))}onItemAdded(e){this._onItemAddListener=e}get data(){return this._data}set data(e){if(0!=this._data.length&&null!=this._onItemAddListener){const t=Date.now();for(let t=0;t<e.length;t++){let r;r=t>=this.children.length?this.program.duplicate(this.children[t-1]):this.children[t];const n=new P(this.program.storeId,{container:r.element,debug:this.program.debug,idMap:this.program.queryIdMap??void 0});this._onItemAddListener((e=>0==t?n.query(e):n.query(Array.isArray(e)?e.map((e=>Q(e,t,this))):Q(e,t,this))),e[t],t)}if(console.log(`onItemAdd Took: ${Date.now()-t}ms`),this._data.length>e.length)for(let t=0;t<this._data.length-e.length;t++)this.program.delete(this.children[this.children.length-1])}this._data=e}}function Q(e,t,r){if(Array.isArray(e))return e.map((e=>Q(e,r)));{const[n,s]=r.children[0].childLocations.entries().find((([t,n])=>null==r.program.queryIdMap?n.id==e.slice(1):n.id==r.program.queryIdMap[e.slice(1)]));return`#${r.children[t].childLocations.get(n).id}`}}class V extends b{childLocations=new Map;constructor(e,t,r){super("repeater_item",e,t,r)}onLoaded(){function e(t,r,n){t.children.forEach(((t,s)=>{const i=`${r}${s.toString(16).padStart(2,"0")}`;n.set(i,t),e(t,i,n)}))}this.children.forEach(((t,r)=>{const n=r.toString(16).padStart(2,"0");this.childLocations.set(n,t),e(t,n,this.childLocations)}))}}f(V,[d]);class G extends b{constructor(e,t,r){super("widget",e,t,r)}}const X=["text","image","button","header","footer","website","multi_state_box","multi_state_box_item","menu","input","repeater","repeater_item","gallery","form","container","section","video","vector_art","iframe","stack","global","accordion","accordion_item","widget"];function z(e){return X.includes(e)}const J=["Text","Image","Button","Header","Footer","Website","MultiStateBox","MultiStateBoxItem","Menu","Input","Repeater","RepeaterItem","Gallery","ContactForm","Container","Section","Video","VectorArt","IFrame","Stack","Global","Accordion","AccordionItem","Widget"];function K(e,t,r,n){switch(e){case"website":return new F(t,r,n);case"header":return new k(t,r,n);case"footer":return new E(t,r,n);case"global":return new v(t,r,n);case"section":return new O(t,r,n);case"container":return new x(t,r,n);case"button":return new I(t,r,n);case"image":return new T(t,r,n);case"text":return new j(t,r,n);case"menu":return new $(t,r,n);case"input":return new S(t,r,n);case"repeater":return new W(t,r,n);case"repeater_item":return new V(t,r,n);case"gallery":return new H(t,r,n);case"form":return new A(t,r,n);case"vector_art":return new q(t,r,n);case"iframe":return new L(t,r,n);case"stack":return new D(t,r,n);case"multi_state_box":return new N(t,r,n);case"multi_state_box_item":return new C(t,r,n);case"accordion":return new y(t,r,n);case"accordion_item":return new w(t,r,n);case"widget":return new G(t,r,n);default:throw new Error(`Unknown Type: ${e}`)}}function Y(e){switch(e){case"website":return F;case"header":return k;case"footer":return E;case"global":return v;case"section":return O;case"container":return x;case"button":return I;case"image":return T;case"text":return j;case"menu":return $;case"input":return S;case"repeater":return W;case"repeater_item":return V;case"gallery":return H;case"form":return A;case"vector_art":return q;case"iframe":return L;case"stack":return D;case"multi_state_box":return N;case"multi_state_box_item":return C;case"accordion":return y;case"accordion_item":return w;case"widget":return G;default:throw new Error(`Unknown Type: ${e}`)}}function Z(e){switch(e){case"website":return"Website";case"header":return"Header";case"footer":return"Footer";case"global":return"Global";case"section":return"Section";case"container":return"Container";case"button":return"Button";case"image":return"Image";case"text":return"Text";case"menu":return"Menu";case"input":return"Input";case"repeater":return"Repeater";case"repeater_item":return"RepeaterItem";case"gallery":return"Gallery";case"form":return"ContactForm";case"vector_art":return"VectorArt";case"iframe":return"IFrame";case"stack":return"Stack";case"multi_state_box":return"MultiStateBox";case"multi_state_box_item":return"MultiStateBoxItem";case"accordion":return"Accordion";case"accordion_item":return"AccordionItem";case"widget":return"Widget";default:throw new Error(`Unknown Type: ${e}`)}}function ee(e,t){const r=new P(e,t),n=(e,t)=>r.query(e,t);return n.program=r,n.storeId=r.storeId,n.debug=r.debug,null!=t?.windowAssign&&!0!==t.windowAssign||Object.assign(window,{excalibur:n,$t:n}),n}const te=ee;scripting=a})();